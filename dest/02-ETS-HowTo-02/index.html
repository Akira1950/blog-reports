<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"></head><body>
[WIP]TypeScriptでenchant.jsを使ってサンプルを作ってみる その2<br>
<br><b>はじめに</b><br>TypeScriptでenchant.jsを開発するためのライブラリ「ets-framework」を作成しました。<br><a href="https://github.com/kazenetu/enchantjs-typescript">https://github.com/kazenetu/enchantjs-typescript</a><br>「starter/use-framework/template/」を使ってサンプルプログラムを開発しています。<br>
<br><b>今回のゴール</b><br>「Hello world」を表示します。<br>
<br><b>前提</b><br>ビルド環境の構築を参照して、下記を実行してください。<br>・ templateフォルダの展開<br>・ <code style="_font-family: 'courier new', monospace; background-color: #EEF; color: #000; font-family: monospace, monospace; font-size: 0.98em;">npm install</code>の実行  <br>
<br><b>ソースコード</b><br><a href="https://github.com/kazenetu/blog-reports/tree/master/reports/02-ETS-HowTo-02/template">https://github.com/kazenetu/blog-reports/tree/master/reports/02-ETS-HowTo-02/template</a><br>
<br><b>開発環境</b><br>下記がインストールされている前提です。<br>カッコ内は私の環境です。  <br>
<ul>
<li>Node.js（5.6.0以上）</li>
<li>npm(3以上)</li>
</ul>
<br><b>実装手順</b><br>1.template/main.tsを開き、Rf.ETS.FrameWork.Labelの追加を行ってください。<br>※処理を追加していないメソッドは除外しています。<br>
<pre style="background-color: #EFF4E4; overflow: auto; white-space: pre-wrap; word-wrap: break-word;"><code class="lang-typesctipt" style="_font-family: 'courier new', monospace; background-color: #EFF4E4; color: #000; font-family: monospace, monospace; font-size: 0.98em;"><span class="hljs-class"><span class="hljs-keyword" style="color: #00f;">class</span> <span class="hljs-title" style="color: #a31515;">GameMain</span> <span class="hljs-title" style="color: #a31515;">extends</span> <span class="hljs-title" style="color: #a31515;">Rf</span>.<span class="hljs-title" style="color: #a31515;">ETS</span>.<span class="hljs-title" style="color: #a31515;">FrameWork</span>.<span class="hljs-title" style="color: #a31515;">GameMain</span> </span>{
    <span class="hljs-comment" style="color: #008000;">//TODO プロパティやフィールドを記述してください。</span>
    <span class="hljs-keyword" style="color: #00f;">private</span> hellow:Rf.ETS.FrameWork.Label = <span class="hljs-literal" style="color: #a31515;">null</span>;

    <span class="hljs-comment" style="color: #008000;">/**
     * 初期化イベント
     * <span class="hljs-doctag" style="color: #808080;">@method</span>
     * <span class="hljs-doctag" style="color: #808080;">@name</span> FrameWork.GameMain#onInitialize
     */</span>
    <span class="hljs-keyword" style="color: #00f;">protected</span> onInitialize(): void {
        <span class="hljs-comment" style="color: #008000;">//サイズを320x480に変更</span>
        <span class="hljs-keyword" style="color: #00f;">this</span>.screenWidth = <span class="hljs-number">320</span>;
        <span class="hljs-keyword" style="color: #00f;">this</span>.screenHeight = <span class="hljs-number">480</span>;

        <span class="hljs-comment" style="color: #008000;">//fpsを設定</span>
        <span class="hljs-keyword" style="color: #00f;">this</span>.fps = <span class="hljs-number">20</span>;
    }

    <span class="hljs-comment" style="color: #008000;">/**
     * ロードイベント
     * <span class="hljs-doctag" style="color: #808080;">@method</span>
     * <span class="hljs-doctag" style="color: #808080;">@name</span> FrameWork.GameMain#onLoad
     * <span class="hljs-doctag" style="color: #808080;">@param</span> {Object} parent - 親Group
     */</span>
    <span class="hljs-keyword" style="color: #00f;">protected</span> onLoad(parent: enchant.Group): void {
        <span class="hljs-comment" style="color: #008000;">//ラベルを生成</span>
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow = new Rf.ETS.FrameWork.Label(parent);
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.text = <span class="hljs-string" style="color: #a31515;">"Hello world"</span>;
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.width = <span class="hljs-number">100</span>;
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.touchEnabled = <span class="hljs-literal" style="color: #a31515;">false</span>;
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.textAlign = <span class="hljs-string" style="color: #a31515;">"center"</span>;
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.x = <span class="hljs-number">100</span>;
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.y = <span class="hljs-number">0</span>;

        <span class="hljs-comment" style="color: #008000;">//TODO イベントを記述してください。</span>

    }

    <span class="hljs-comment" style="color: #008000;">/**
     * 実行イベント
     * <span class="hljs-doctag" style="color: #808080;">@method</span>
     * <span class="hljs-doctag" style="color: #808080;">@name</span> FrameWork.GameMain#onRun
     */</span>
    <span class="hljs-keyword" style="color: #00f;">protected</span> onRun(): void {
        <span class="hljs-comment" style="color: #008000;">//ラベルを移動させる</span>
        <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.y += <span class="hljs-number">4</span>;
        <span class="hljs-keyword" style="color: #00f;">if</span>(<span class="hljs-keyword" style="color: #00f;">this</span>.hellow.y &gt; <span class="hljs-number">480</span>){
          <span class="hljs-keyword" style="color: #00f;">this</span>.hellow.y -= <span class="hljs-number">480</span>;
        }
    }
}

</code></pre>
実装内容は以下のとおりです。<br>
<ol>
<li>GameMainクラスに「hellow」フィールドを追加</li>
<li>onInitializeメソッド（一回だけ呼ばれる）<br>今回) 画面サイズとfps(1秒間の描画回数)を設定</li>
<li>onLoadメソッド（一回だけ呼ばれる）<br>今回) 「hellow」フィールドの生成・設定</li>
<li>onRunメソッド（描画ごとに呼ばれる）<br>今回) 「hellow」フィールドの移動(上から下に移動。下まで行ったら0に戻す)</li>
</ol>
2.<code style="_font-family: 'courier new', monospace; background-color: #EEF; color: #000; font-family: monospace, monospace; font-size: 0.98em;">npm run build</code> または <code style="_font-family: 'courier new', monospace; background-color: #EEF; color: #000; font-family: monospace, monospace; font-size: 0.98em;">gulp default</code>でビルドを行います。<br>
<br><b>おわりに</b><br>今回はラベルの生成と表示を行いました。<br>次回はイベントの実装を行います。<br>
<br>
よかったらクリックしてください。<br><a href="http://it.blogmura.com/"><img src="http://it.blogmura.com/img/it88_31.gif" width="88" height="31" border="0" alt="にほんブログ村 ＩＴ技術ブログへ"></a><br><a href="http://game.blogmura.com/game_work/"><img src="http://game.blogmura.com/game_work/img/game_work88_31.gif" width="88" height="31" border="0" alt="にほんブログ村 ゲームブログ ゲーム制作へ"></a><br><a href="http://game.blogmura.com/game_work/">にほんブログ村</a><br>
</body></html>